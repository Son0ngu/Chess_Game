{"ast":null,"code":"var _jsxFileName = \"D:\\\\Code\\\\Chess_Game\\\\chess_frontend\\\\src\\\\pages\\\\Play.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport Board from \"../components/Board\";\nimport MoveHistory from \"../components/MoveHistory\";\nimport GameControls from \"../components/GameControls\";\nimport Spinner from \"../components/Spinner\";\nimport { socket } from \"../services/socket\";\nimport useChess from \"../hooks/useChess\";\nimport \"../styles/Play.css\";\n\n// Safe string helper to avoid substring errors\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst safeString = value => {\n  if (value === null || value === undefined) return '';\n  if (typeof value === 'string') return value;\n  return String(value);\n};\n\n// Safe array helper to avoid map errors\nconst safeArray = arr => {\n  if (!arr) return [];\n  if (!Array.isArray(arr)) return [];\n  return arr;\n};\nconst Play = () => {\n  _s();\n  // Hooks for routing and authentication\n  const {\n    gameId\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user,\n    isAuthenticated\n  } = useAuth();\n\n  // Game state\n  const [opponent, setOpponent] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [gameOver, setGameOver] = useState(false);\n  const [gameResult, setGameResult] = useState(null);\n  const [showResignDialog, setShowResignDialog] = useState(false);\n  const [showDrawOfferDialog, setShowDrawOfferDialog] = useState(false);\n  const [receivedDrawOffer, setReceivedDrawOffer] = useState(false);\n\n  // Debug state\n  const [showDebug, setShowDebug] = useState(process.env.NODE_ENV === 'development');\n  const [debugInfo, setDebugInfo] = useState({\n    gameId: safeString(gameId) || 'Not set',\n    socketConnected: socket.connected,\n    loadAttempts: 0,\n    errors: []\n  });\n\n  // Get chess game state from custom hook\n  const {\n    board,\n    currentTurn,\n    playerColor,\n    moves,\n    makeMove,\n    position,\n    inCheck,\n    possibleMoves,\n    gameStatus\n  } = useChess(gameId);\n\n  // Create safe versions of all potentially problematic values\n  const safeGameId = useMemo(() => safeString(gameId), [gameId]);\n  const safePlayerColor = useMemo(() => safeString(playerColor || 'white'), [playerColor]);\n  const safeUsername = useMemo(() => user ? safeString(user.username || 'Player') : 'Player', [user]);\n  const safeOpponentName = useMemo(() => opponent ? safeString(opponent.username || 'Opponent') : 'Opponent', [opponent]);\n  const safeMoves = useMemo(() => safeArray(moves), [moves]);\n\n  // Handle error display safely\n  const addError = message => {\n    try {\n      setDebugInfo(prev => ({\n        ...prev,\n        errors: [...safeArray(prev.errors), {\n          time: new Date().toLocaleTimeString(),\n          message: safeString(message)\n        }]\n      }));\n    } catch (error) {\n      console.error(\"Failed to add error to debug info:\", error);\n    }\n  };\n\n  // Add game:matched event handler\n  useEffect(() => {\n    const handleMatchFound = data => {\n      try {\n        console.log(\"Match found!\", data ? JSON.stringify(data) : 'No data');\n        if (!data) {\n          addError(\"Empty match data received\");\n          return;\n        }\n        if (!data.gameId) {\n          addError(\"Invalid match data - missing gameId\");\n          return;\n        }\n\n        // Make sure gameId is valid\n        const newGameId = safeString(data.gameId);\n        if (newGameId === \"undefined\" || newGameId === \"\") {\n          addError(`Invalid gameId format: ${newGameId}`);\n          return;\n        }\n        console.log(`âœ“ Valid gameId received: ${newGameId}`);\n        navigate(`/play/${newGameId}`);\n      } catch (error) {\n        addError(`Match error: ${(error === null || error === void 0 ? void 0 : error.message) || \"Unknown error\"}`);\n        console.error(\"Error processing match data:\", error);\n      }\n    };\n    socket.on(\"game:matched\", handleMatchFound);\n    return () => {\n      socket.off(\"game:matched\", handleMatchFound);\n    };\n  }, [navigate]);\n\n  // Check for undefined gameId in URL\n  useEffect(() => {\n    try {\n      if (window.location.pathname.includes('/play/undefined')) {\n        console.error(\"âš ï¸ DETECTED 'undefined' IN URL PATH!\");\n        addError(\"URL contains 'undefined' instead of a valid gameId\");\n\n        // Redirect to play page after short delay\n        setTimeout(() => navigate('/play'), 3000);\n      } else if (safeGameId) {\n        console.log(`ðŸŽ® Game ID from URL params: ${safeGameId}`);\n        setDebugInfo(prev => ({\n          ...prev,\n          gameId: safeGameId\n        }));\n      }\n    } catch (error) {\n      console.error(\"Error checking URL:\", error);\n    }\n  }, [safeGameId, navigate]);\n\n  // Handle authentication redirect\n  useEffect(() => {\n    try {\n      if (!isAuthenticated && !isLoading) {\n        navigate(\"/signin\");\n      }\n    } catch (error) {\n      console.error(\"Error handling auth redirect:\", error);\n    }\n  }, [isAuthenticated, navigate, isLoading]);\n\n  // Track socket connection\n  useEffect(() => {\n    try {\n      const handleConnect = () => {\n        console.log(\"ðŸ”Œ Socket connected\");\n        setDebugInfo(prev => ({\n          ...prev,\n          socketConnected: true\n        }));\n      };\n      const handleDisconnect = () => {\n        console.log(\"ðŸ”Œ Socket disconnected\");\n        setDebugInfo(prev => ({\n          ...prev,\n          socketConnected: false\n        }));\n        addError(\"Socket disconnected while on game page\");\n      };\n      socket.on('connect', handleConnect);\n      socket.on('disconnect', handleDisconnect);\n      return () => {\n        socket.off('connect', handleConnect);\n        socket.off('disconnect', handleDisconnect);\n      };\n    } catch (error) {\n      console.error(\"Error setting up socket listeners:\", error);\n    }\n  }, []);\n\n  // Initial game setup\n  useEffect(() => {\n    try {\n      if (!safeGameId || !isAuthenticated) {\n        if (!safeGameId) {\n          console.log(\"No gameId provided, showing matchmaking\");\n        }\n        return;\n      }\n      setIsLoading(true);\n\n      // Debug: Log load attempt\n      setDebugInfo(prev => ({\n        ...prev,\n        loadAttempts: (prev.loadAttempts || 0) + 1\n      }));\n      console.log(`ðŸŽ² Joining game room for gameId: ${safeGameId}`);\n\n      // Join game room\n      socket.emit(\"game:join\", {\n        gameId: safeGameId\n      });\n\n      // Get game data\n      const handleGameData = data => {\n        try {\n          console.log(`ðŸ“Š Received game data:`, data ? JSON.stringify(data) : 'No data');\n\n          // SAFETY CHECK: Ensure data is valid before processing\n          if (!data) {\n            addError(\"Received empty game data\");\n            setIsLoading(false);\n            return;\n          }\n\n          // Get opponent information - add safety check here\n          let opponentPlayer = null;\n          try {\n            if (data.players && Array.isArray(data.players)) {\n              // Safely find opponent\n              for (let i = 0; i < data.players.length; i++) {\n                const player = data.players[i];\n                if (!player) continue; // Skip if player is null/undefined\n\n                // Make sure we have user data to compare with\n                if (!user || !user.id) {\n                  addError(\"Cannot determine opponent: missing user data\");\n                  continue;\n                }\n\n                // Only consider players with IDs\n                if (!player.id) continue;\n\n                // Found opponent if IDs differ\n                if (safeString(player.id) !== safeString(user.id)) {\n                  opponentPlayer = {\n                    id: safeString(player.id),\n                    username: safeString(player.username || 'Opponent'),\n                    elo: player.elo || '?'\n                  };\n                  break;\n                }\n              }\n            }\n          } catch (err) {\n            console.error(\"Error finding opponent in players array:\", err);\n            addError(`Error finding opponent: ${err.message}`);\n          }\n          if (opponentPlayer) {\n            setOpponent(opponentPlayer);\n            console.log(`ðŸ‘¤ Found opponent: ${opponentPlayer.username}`);\n          } else {\n            console.warn(\"âš ï¸ Could not find opponent in game data\");\n            addError(\"Could not find opponent in game data\");\n          }\n        } catch (error) {\n          console.error(\"Error processing game data:\", error);\n          addError(`Game data error: ${error.message}`);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      const handleGameError = error => {\n        try {\n          console.error(`âŒ Game error:`, error);\n          const errorMessage = safeString(error && typeof error === 'object' ? error.message || JSON.stringify(error) : String(error || \"Unknown error\"));\n          addError(`Game error: ${errorMessage}`);\n        } catch (e) {\n          console.error(\"Error handling game error:\", e);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      socket.on(\"game:data\", handleGameData);\n      socket.on(\"game:error\", handleGameError);\n\n      // Listen for game over events\n      socket.on(\"game:over\", data => {\n        try {\n          console.log(`ðŸ Game over:`, data);\n          setGameOver(true);\n          setGameResult(data && data.result ? data.result : null);\n        } catch (error) {\n          console.error(\"Error handling game over:\", error);\n          addError(`Game over error: ${error.message}`);\n        }\n      });\n\n      // Listen for draw offers\n      socket.on(\"game:drawOffered\", data => {\n        try {\n          console.log(`ðŸ¤ Draw offered`);\n          setReceivedDrawOffer(true);\n        } catch (error) {\n          console.error(\"Error handling draw offer:\", error);\n          addError(`Draw offer error: ${error.message}`);\n        }\n      });\n      return () => {\n        // Clean up socket listeners when component unmounts\n        try {\n          console.log(`ðŸ§¹ Cleaning up socket listeners and leaving game`);\n          socket.off(\"game:data\", handleGameData);\n          socket.off(\"game:error\", handleGameError);\n          socket.off(\"game:over\");\n          socket.off(\"game:drawOffered\");\n          if (safeGameId) {\n            socket.emit(\"game:leave\", {\n              gameId: safeGameId\n            });\n          }\n        } catch (error) {\n          console.error(\"Error during cleanup:\", error);\n        }\n      };\n    } catch (error) {\n      console.error(\"Error in game setup effect:\", error);\n      addError(`Game setup error: ${error.message}`);\n      setIsLoading(false);\n    }\n  }, [safeGameId, isAuthenticated, user]);\n\n  // Check for game status changes\n  useEffect(() => {\n    try {\n      if (gameStatus && gameStatus.isGameOver) {\n        console.log(`â™Ÿï¸ Game status change to game over:`, gameStatus);\n        setGameOver(true);\n        setGameResult(gameStatus.result || null);\n      }\n    } catch (error) {\n      console.error(\"Error handling game status change:\", error);\n      addError(`Game status error: ${error.message}`);\n    }\n  }, [gameStatus]);\n  const handleResign = () => {\n    try {\n      console.log(`ðŸ³ï¸ Resigning game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:resign\", {\n          gameId: safeGameId\n        });\n      }\n      setGameOver(true);\n      setGameResult({\n        type: \"resignation\",\n        winner: opponent && opponent.id ? opponent.id : null\n      });\n      setShowResignDialog(false);\n    } catch (error) {\n      console.error(\"Error handling resign:\", error);\n      addError(`Resign error: ${error.message}`);\n    }\n  };\n  const handleOfferDraw = () => {\n    try {\n      console.log(`ðŸ¤ Offering draw in game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:offerDraw\", {\n          gameId: safeGameId\n        });\n      }\n      setShowDrawOfferDialog(false);\n    } catch (error) {\n      console.error(\"Error offering draw:\", error);\n      addError(`Draw offer error: ${error.message}`);\n    }\n  };\n  const handleAcceptDraw = () => {\n    try {\n      console.log(`ðŸ¤ Accepting draw in game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:acceptDraw\", {\n          gameId: safeGameId\n        });\n      }\n      setGameOver(true);\n      setGameResult({\n        type: \"draw\",\n        reason: \"agreement\"\n      });\n      setReceivedDrawOffer(false);\n    } catch (error) {\n      console.error(\"Error accepting draw:\", error);\n      addError(`Accept draw error: ${error.message}`);\n    }\n  };\n  const handleDeclineDraw = () => {\n    try {\n      console.log(`ðŸ‘Ž Declining draw in game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:declineDraw\", {\n          gameId: safeGameId\n        });\n      }\n      setReceivedDrawOffer(false);\n    } catch (error) {\n      console.error(\"Error declining draw:\", error);\n      addError(`Decline draw error: ${error.message}`);\n    }\n  };\n  const setUndo = () => {\n    try {\n      console.log(`âª Requesting undo in game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:requestUndo\", {\n          gameId: safeGameId\n        });\n      }\n    } catch (error) {\n      console.error(\"Error requesting undo:\", error);\n      addError(`Undo error: ${error.message}`);\n    }\n  };\n  const setRedo = () => {\n    try {\n      console.log(`â© Requesting redo in game ${safeGameId}`);\n      if (safeGameId) {\n        socket.emit(\"game:requestRedo\", {\n          gameId: safeGameId\n        });\n      }\n    } catch (error) {\n      console.error(\"Error requesting redo:\", error);\n      addError(`Redo error: ${error.message}`);\n    }\n  };\n\n  // Render errors list safely\n  const renderErrorsList = () => {\n    try {\n      const errorsArray = safeArray(debugInfo === null || debugInfo === void 0 ? void 0 : debugInfo.errors);\n      if (errorsArray.length === 0) {\n        return null;\n      }\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"Errors:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          style: {\n            paddingLeft: '15px',\n            margin: '5px 0'\n          },\n          children: errorsArray.map((err, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"[\", safeString((err === null || err === void 0 ? void 0 : err.time) || 'unknown'), \"]\", safeString((err === null || err === void 0 ? void 0 : err.message) || 'Error object')]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this);\n    } catch (error) {\n      console.error(\"Error rendering errors list:\", error);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Error displaying errors list\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 14\n      }, this);\n    }\n  };\n\n  // Conditional rendering after all hooks\n  if (!user && !isLoading) {\n    console.error(\"User object is undefined but authentication check is complete\");\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Authentication Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Unable to retrieve your user information. Please try logging in again.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/signin'),\n        children: \"Go to Sign In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 7\n    }, this);\n  }\n  if (!safeGameId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"matchmaking-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Find a Match\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"matchmaking-options\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            try {\n              console.log(\"Looking for casual match\");\n              socket.emit(\"game:findMatch\", {\n                gameMode: \"casual\",\n                timeControl: \"10min\"\n              });\n            } catch (error) {\n              console.error(\"Error finding casual match:\", error);\n              addError(`Find match error: ${error.message}`);\n            }\n          },\n          children: \"Find Casual Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            try {\n              console.log(\"Looking for ranked match\");\n              socket.emit(\"game:findMatch\", {\n                gameMode: \"ranked\",\n                timeControl: \"10min\"\n              });\n            } catch (error) {\n              console.error(\"Error finding ranked match:\", error);\n              addError(`Find match error: ${error.message}`);\n            }\n          },\n          children: \"Find Ranked Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 9\n      }, this), showDebug && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"debug-box\",\n        style: {\n          marginTop: '20px',\n          padding: '10px',\n          border: '1px solid #666',\n          backgroundColor: '#222',\n          color: '#eee',\n          fontSize: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Debug: Listening for match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Socket connected: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: socket.connected ? '#4CAF50' : '#F44336'\n            },\n            children: socket.connected ? 'Yes' : 'No'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 515,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 476,\n      columnNumber: 7\n    }, this);\n  }\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 9\n      }, this), showDebug && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'fixed',\n          bottom: '10px',\n          right: '10px',\n          background: '#222',\n          color: '#fff',\n          padding: '10px',\n          maxWidth: '300px',\n          fontSize: '11px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Loading game: \", safeGameId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Attempt #\", debugInfo.loadAttempts]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Socket connected: \", debugInfo.socketConnected ? 'Yes' : 'No']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  }\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      style: {\n        padding: \"20px\",\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"User Data Not Available\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Unable to load user data. Please try refreshing or sign in again.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 543,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/signin'),\n        style: {\n          padding: \"10px 20px\",\n          marginTop: \"20px\"\n        },\n        children: \"Go to Sign In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 544,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 541,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"play-container\",\n    children: [showDebug && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: '10px',\n        right: '10px',\n        backgroundColor: 'rgba(0,0,0,0.8)',\n        color: 'white',\n        padding: '10px',\n        zIndex: 1000,\n        fontSize: '11px',\n        maxWidth: '300px',\n        maxHeight: '300px',\n        overflow: 'auto'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowDebug(false),\n        style: {\n          float: 'right',\n          marginLeft: '5px'\n        },\n        children: \"X\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 571,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Game Debug\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Game ID: \", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: safeString((debugInfo === null || debugInfo === void 0 ? void 0 : debugInfo.gameId) || 'Not set')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Socket: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: debugInfo !== null && debugInfo !== void 0 && debugInfo.socketConnected ? 'lime' : 'red'\n          },\n          children: debugInfo !== null && debugInfo !== void 0 && debugInfo.socketConnected ? 'Connected' : 'Disconnected'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 22\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Player: \", safeUsername]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 582,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Opponent: \", safeOpponentName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Color: \", safePlayerColor]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 584,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Turn: \", safeString(currentTurn || 'Unknown')]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 585,\n        columnNumber: 11\n      }, this), renderErrorsList()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-info\",\n      children: [opponent && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"opponent-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: safeOpponentName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rating\",\n          children: [\"Rating: \", opponent.elo || '?']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 593,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-status\",\n        children: gameOver ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-result\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Game Over\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 602,\n            columnNumber: 15\n          }, this), gameResult && gameResult.type === \"checkmate\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Checkmate! \", user && gameResult.winner === user.id ? \"You won\" : \"You lost\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 604,\n            columnNumber: 17\n          }, this), gameResult && gameResult.type === \"draw\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Game drawn by \", safeString(gameResult.reason) || 'agreement']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 17\n          }, this), gameResult && gameResult.type === \"resignation\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: user && gameResult.winner === user.id ? \"Opponent resigned. You won!\" : \"You resigned. You lost.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 614,\n            columnNumber: 17\n          }, this), gameResult && gameResult.type === \"timeout\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: user && gameResult.winner === user.id ? \"Opponent ran out of time. You won!\" : \"You ran out of time. You lost.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"new-game-btn\",\n            onClick: () => navigate(\"/lobby\"),\n            children: \"Back to Lobby\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 627,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 601,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"current-turn\",\n            children: currentTurn === safePlayerColor ? \"Your turn\" : \"Opponent's turn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 636,\n            columnNumber: 15\n          }, this), inCheck && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"check-alert\",\n            children: \"Check!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 635,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 599,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-board-container\",\n      children: /*#__PURE__*/_jsxDEV(Board, {\n        board: safeArray(board),\n        position: position && typeof position === 'object' ? position : {},\n        playerColor: safePlayerColor,\n        possibleMoves: possibleMoves && typeof possibleMoves === 'object' ? possibleMoves : {},\n        onMove: makeMove,\n        disabled: gameOver || currentTurn !== safePlayerColor\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 646,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 645,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"move-history-container\",\n        children: /*#__PURE__*/_jsxDEV(MoveHistory, {\n          moves: safeMoves\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 658,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 657,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game-controls-container\",\n        children: /*#__PURE__*/_jsxDEV(GameControls, {\n          onNewGame: () => navigate(\"/lobby\"),\n          canResign: !gameOver,\n          onResign: () => setShowResignDialog(true),\n          canOfferDraw: !gameOver,\n          onOfferDraw: () => setShowDrawOfferDialog(true),\n          canUndo: safeMoves.length > 0 && !gameOver,\n          onUndoRequest: () => setUndo(),\n          canRedo: true,\n          onRedoRequest: () => setRedo()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 662,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 661,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"player-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"You (\", safePlayerColor, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rating\",\n          children: [\"Rating: \", user && typeof user.elo !== 'undefined' ? user.elo : '?']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 678,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 676,\n        columnNumber: 9\n      }, this), process.env.NODE_ENV === 'development' && !showDebug && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowDebug(true),\n        style: {\n          position: 'fixed',\n          bottom: '10px',\n          right: '10px',\n          background: '#444',\n          color: '#fff',\n          border: 'none',\n          padding: '5px 10px',\n          borderRadius: '4px',\n          cursor: 'pointer',\n          fontSize: '12px'\n        },\n        children: \"Show Debug\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 683,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 656,\n      columnNumber: 7\n    }, this), showResignDialog && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dialog-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dialog\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Resign Game?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Are you sure you want to resign? This will count as a loss.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dialog-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleResign,\n            className: \"confirm-btn\",\n            children: \"Yes, Resign\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 710,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowResignDialog(false),\n            className: \"cancel-btn\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 709,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 706,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 705,\n      columnNumber: 9\n    }, this), showDrawOfferDialog && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dialog-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dialog\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Offer Draw?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 725,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Send a draw offer to your opponent?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 726,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dialog-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleOfferDraw,\n            className: \"confirm-btn\",\n            children: \"Yes, Offer Draw\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 728,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowDrawOfferDialog(false),\n            className: \"cancel-btn\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 727,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 724,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 723,\n      columnNumber: 9\n    }, this), receivedDrawOffer && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dialog-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dialog\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Draw Offered\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 743,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Your opponent has offered a draw. Do you accept?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 744,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dialog-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleAcceptDraw,\n            className: \"confirm-btn\",\n            children: \"Accept Draw\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 746,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDeclineDraw,\n            className: \"cancel-btn\",\n            children: \"Decline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 745,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 742,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 741,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 555,\n    columnNumber: 5\n  }, this);\n};\n_s(Play, \"A1kSaukWx80tn0CFxMz3AxTzU0A=\", false, function () {\n  return [useParams, useNavigate, useAuth, useChess];\n});\n_c = Play;\nexport default Play;\nvar _c;\n$RefreshReg$(_c, \"Play\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useParams","useNavigate","useAuth","Board","MoveHistory","GameControls","Spinner","socket","useChess","jsxDEV","_jsxDEV","Fragment","_Fragment","safeString","value","undefined","String","safeArray","arr","Array","isArray","Play","_s","gameId","navigate","user","isAuthenticated","opponent","setOpponent","isLoading","setIsLoading","gameOver","setGameOver","gameResult","setGameResult","showResignDialog","setShowResignDialog","showDrawOfferDialog","setShowDrawOfferDialog","receivedDrawOffer","setReceivedDrawOffer","showDebug","setShowDebug","process","env","NODE_ENV","debugInfo","setDebugInfo","socketConnected","connected","loadAttempts","errors","board","currentTurn","playerColor","moves","makeMove","position","inCheck","possibleMoves","gameStatus","safeGameId","safePlayerColor","safeUsername","username","safeOpponentName","safeMoves","addError","message","prev","time","Date","toLocaleTimeString","error","console","handleMatchFound","data","log","JSON","stringify","newGameId","on","off","window","location","pathname","includes","setTimeout","handleConnect","handleDisconnect","emit","handleGameData","opponentPlayer","players","i","length","player","id","elo","err","warn","handleGameError","errorMessage","e","result","isGameOver","handleResign","type","winner","handleOfferDraw","handleAcceptDraw","reason","handleDeclineDraw","setUndo","setRedo","renderErrorsList","errorsArray","children","fileName","_jsxFileName","lineNumber","columnNumber","style","paddingLeft","margin","map","className","onClick","gameMode","timeControl","marginTop","padding","border","backgroundColor","color","fontSize","bottom","right","background","maxWidth","textAlign","top","zIndex","maxHeight","overflow","float","marginLeft","onMove","disabled","onNewGame","canResign","onResign","canOfferDraw","onOfferDraw","canUndo","onUndoRequest","canRedo","onRedoRequest","borderRadius","cursor","_c","$RefreshReg$"],"sources":["D:/Code/Chess_Game/chess_frontend/src/pages/Play.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport Board from \"../components/Board\";\r\nimport MoveHistory from \"../components/MoveHistory\";\r\nimport GameControls from \"../components/GameControls\";\r\nimport Spinner from \"../components/Spinner\";\r\nimport { socket } from \"../services/socket\";\r\nimport useChess from \"../hooks/useChess\";\r\nimport \"../styles/Play.css\";\r\n\r\n// Safe string helper to avoid substring errors\r\nconst safeString = (value) => {\r\n  if (value === null || value === undefined) return '';\r\n  if (typeof value === 'string') return value;\r\n  return String(value);\r\n};\r\n\r\n// Safe array helper to avoid map errors\r\nconst safeArray = (arr) => {\r\n  if (!arr) return [];\r\n  if (!Array.isArray(arr)) return [];\r\n  return arr;\r\n};\r\n\r\nconst Play = () => {\r\n  // Hooks for routing and authentication\r\n  const { gameId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user, isAuthenticated } = useAuth();\r\n  \r\n  // Game state\r\n  const [opponent, setOpponent] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [gameOver, setGameOver] = useState(false);\r\n  const [gameResult, setGameResult] = useState(null);\r\n  const [showResignDialog, setShowResignDialog] = useState(false);\r\n  const [showDrawOfferDialog, setShowDrawOfferDialog] = useState(false);\r\n  const [receivedDrawOffer, setReceivedDrawOffer] = useState(false);\r\n  \r\n  // Debug state\r\n  const [showDebug, setShowDebug] = useState(process.env.NODE_ENV === 'development');\r\n  const [debugInfo, setDebugInfo] = useState({\r\n    gameId: safeString(gameId) || 'Not set',\r\n    socketConnected: socket.connected,\r\n    loadAttempts: 0,\r\n    errors: []\r\n  });\r\n\r\n  // Get chess game state from custom hook\r\n  const {\r\n    board,\r\n    currentTurn,\r\n    playerColor,\r\n    moves,\r\n    makeMove,\r\n    position,\r\n    inCheck,\r\n    possibleMoves,\r\n    gameStatus\r\n  } = useChess(gameId);\r\n  \r\n  // Create safe versions of all potentially problematic values\r\n  const safeGameId = useMemo(() => safeString(gameId), [gameId]);\r\n  const safePlayerColor = useMemo(() => safeString(playerColor || 'white'), [playerColor]);\r\n  const safeUsername = useMemo(() => user ? safeString(user.username || 'Player') : 'Player', [user]);\r\n  const safeOpponentName = useMemo(() => opponent ? safeString(opponent.username || 'Opponent') : 'Opponent', [opponent]);\r\n  const safeMoves = useMemo(() => safeArray(moves), [moves]);\r\n  \r\n  // Handle error display safely\r\n  const addError = (message) => {\r\n    try {\r\n      setDebugInfo(prev => ({\r\n        ...prev,\r\n        errors: [\r\n          ...safeArray(prev.errors),\r\n          { time: new Date().toLocaleTimeString(), message: safeString(message) }\r\n        ]\r\n      }));\r\n    } catch (error) {\r\n      console.error(\"Failed to add error to debug info:\", error);\r\n    }\r\n  };\r\n  \r\n  // Add game:matched event handler\r\n  useEffect(() => {\r\n    const handleMatchFound = (data) => {\r\n      try {\r\n        console.log(\"Match found!\", data ? JSON.stringify(data) : 'No data');\r\n        \r\n        if (!data) {\r\n          addError(\"Empty match data received\");\r\n          return;\r\n        }\r\n        \r\n        if (!data.gameId) {\r\n          addError(\"Invalid match data - missing gameId\");\r\n          return;\r\n        }\r\n        \r\n        // Make sure gameId is valid\r\n        const newGameId = safeString(data.gameId);\r\n        if (newGameId === \"undefined\" || newGameId === \"\") {\r\n          addError(`Invalid gameId format: ${newGameId}`);\r\n          return;\r\n        }\r\n        \r\n        console.log(`âœ“ Valid gameId received: ${newGameId}`);\r\n        navigate(`/play/${newGameId}`);\r\n      } catch (error) {\r\n        addError(`Match error: ${error?.message || \"Unknown error\"}`);\r\n        console.error(\"Error processing match data:\", error);\r\n      }\r\n    };\r\n    \r\n    socket.on(\"game:matched\", handleMatchFound);\r\n    \r\n    return () => {\r\n      socket.off(\"game:matched\", handleMatchFound);\r\n    };\r\n  }, [navigate]);\r\n  \r\n  // Check for undefined gameId in URL\r\n  useEffect(() => {\r\n    try {\r\n      if (window.location.pathname.includes('/play/undefined')) {\r\n        console.error(\"âš ï¸ DETECTED 'undefined' IN URL PATH!\");\r\n        addError(\"URL contains 'undefined' instead of a valid gameId\");\r\n        \r\n        // Redirect to play page after short delay\r\n        setTimeout(() => navigate('/play'), 3000);\r\n      } else if (safeGameId) {\r\n        console.log(`ðŸŽ® Game ID from URL params: ${safeGameId}`);\r\n        setDebugInfo(prev => ({\r\n          ...prev,\r\n          gameId: safeGameId\r\n        }));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error checking URL:\", error);\r\n    }\r\n  }, [safeGameId, navigate]);\r\n  \r\n  // Handle authentication redirect\r\n  useEffect(() => {\r\n    try {\r\n      if (!isAuthenticated && !isLoading) {\r\n        navigate(\"/signin\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error handling auth redirect:\", error);\r\n    }\r\n  }, [isAuthenticated, navigate, isLoading]);\r\n\r\n  // Track socket connection\r\n  useEffect(() => {\r\n    try {\r\n      const handleConnect = () => {\r\n        console.log(\"ðŸ”Œ Socket connected\");\r\n        setDebugInfo(prev => ({\r\n          ...prev,\r\n          socketConnected: true\r\n        }));\r\n      };\r\n      \r\n      const handleDisconnect = () => {\r\n        console.log(\"ðŸ”Œ Socket disconnected\");\r\n        setDebugInfo(prev => ({\r\n          ...prev,\r\n          socketConnected: false\r\n        }));\r\n        addError(\"Socket disconnected while on game page\");\r\n      };\r\n      \r\n      socket.on('connect', handleConnect);\r\n      socket.on('disconnect', handleDisconnect);\r\n      \r\n      return () => {\r\n        socket.off('connect', handleConnect);\r\n        socket.off('disconnect', handleDisconnect);\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error setting up socket listeners:\", error);\r\n    }\r\n  }, []);\r\n\r\n  // Initial game setup\r\n  useEffect(() => {\r\n    try {\r\n      if (!safeGameId || !isAuthenticated) {\r\n        if (!safeGameId) {\r\n          console.log(\"No gameId provided, showing matchmaking\");\r\n        }\r\n        return;\r\n      }\r\n\r\n      setIsLoading(true);\r\n      \r\n      // Debug: Log load attempt\r\n      setDebugInfo(prev => ({\r\n        ...prev,\r\n        loadAttempts: (prev.loadAttempts || 0) + 1\r\n      }));\r\n      \r\n      console.log(`ðŸŽ² Joining game room for gameId: ${safeGameId}`);\r\n\r\n      // Join game room\r\n      socket.emit(\"game:join\", { gameId: safeGameId });\r\n\r\n      // Get game data\r\n      const handleGameData = (data) => {\r\n        try {\r\n          console.log(`ðŸ“Š Received game data:`, data ? JSON.stringify(data) : 'No data');\r\n          \r\n          // SAFETY CHECK: Ensure data is valid before processing\r\n          if (!data) {\r\n            addError(\"Received empty game data\");\r\n            setIsLoading(false);\r\n            return;\r\n          }\r\n          \r\n          // Get opponent information - add safety check here\r\n          let opponentPlayer = null;\r\n          \r\n          try {\r\n            if (data.players && Array.isArray(data.players)) {\r\n              // Safely find opponent\r\n              for (let i = 0; i < data.players.length; i++) {\r\n                const player = data.players[i];\r\n                if (!player) continue; // Skip if player is null/undefined\r\n                \r\n                // Make sure we have user data to compare with\r\n                if (!user || !user.id) {\r\n                  addError(\"Cannot determine opponent: missing user data\");\r\n                  continue;\r\n                }\r\n                \r\n                // Only consider players with IDs\r\n                if (!player.id) continue;\r\n                \r\n                // Found opponent if IDs differ\r\n                if (safeString(player.id) !== safeString(user.id)) {\r\n                  opponentPlayer = {\r\n                    id: safeString(player.id),\r\n                    username: safeString(player.username || 'Opponent'),\r\n                    elo: player.elo || '?'\r\n                  };\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n          } catch (err) {\r\n            console.error(\"Error finding opponent in players array:\", err);\r\n            addError(`Error finding opponent: ${err.message}`);\r\n          }\r\n          \r\n          if (opponentPlayer) {\r\n            setOpponent(opponentPlayer);\r\n            console.log(`ðŸ‘¤ Found opponent: ${opponentPlayer.username}`);\r\n          } else {\r\n            console.warn(\"âš ï¸ Could not find opponent in game data\");\r\n            addError(\"Could not find opponent in game data\");\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error processing game data:\", error);\r\n          addError(`Game data error: ${error.message}`);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      };\r\n      \r\n      const handleGameError = (error) => {\r\n        try {\r\n          console.error(`âŒ Game error:`, error);\r\n          const errorMessage = safeString(\r\n            error && typeof error === 'object' ? \r\n              (error.message || JSON.stringify(error)) : \r\n              String(error || \"Unknown error\")\r\n          );\r\n          \r\n          addError(`Game error: ${errorMessage}`);\r\n        } catch (e) {\r\n          console.error(\"Error handling game error:\", e);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      };\r\n      \r\n      socket.on(\"game:data\", handleGameData);\r\n      socket.on(\"game:error\", handleGameError);\r\n\r\n      // Listen for game over events\r\n      socket.on(\"game:over\", (data) => {\r\n        try {\r\n          console.log(`ðŸ Game over:`, data);\r\n          setGameOver(true);\r\n          setGameResult(data && data.result ? data.result : null);\r\n        } catch (error) {\r\n          console.error(\"Error handling game over:\", error);\r\n          addError(`Game over error: ${error.message}`);\r\n        }\r\n      });\r\n\r\n      // Listen for draw offers\r\n      socket.on(\"game:drawOffered\", (data) => {\r\n        try {\r\n          console.log(`ðŸ¤ Draw offered`);\r\n          setReceivedDrawOffer(true);\r\n        } catch (error) {\r\n          console.error(\"Error handling draw offer:\", error);\r\n          addError(`Draw offer error: ${error.message}`);\r\n        }\r\n      });\r\n\r\n      return () => {\r\n        // Clean up socket listeners when component unmounts\r\n        try {\r\n          console.log(`ðŸ§¹ Cleaning up socket listeners and leaving game`);\r\n          socket.off(\"game:data\", handleGameData);\r\n          socket.off(\"game:error\", handleGameError);\r\n          socket.off(\"game:over\");\r\n          socket.off(\"game:drawOffered\");\r\n          \r\n          if (safeGameId) {\r\n            socket.emit(\"game:leave\", { gameId: safeGameId });\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error during cleanup:\", error);\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error in game setup effect:\", error);\r\n      addError(`Game setup error: ${error.message}`);\r\n      setIsLoading(false);\r\n    }\r\n  }, [safeGameId, isAuthenticated, user]);\r\n\r\n  // Check for game status changes\r\n  useEffect(() => {\r\n    try {\r\n      if (gameStatus && gameStatus.isGameOver) {\r\n        console.log(`â™Ÿï¸ Game status change to game over:`, gameStatus);\r\n        setGameOver(true);\r\n        setGameResult(gameStatus.result || null);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error handling game status change:\", error);\r\n      addError(`Game status error: ${error.message}`);\r\n    }\r\n  }, [gameStatus]);\r\n  \r\n  const handleResign = () => {\r\n    try {\r\n      console.log(`ðŸ³ï¸ Resigning game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:resign\", { gameId: safeGameId });\r\n      }\r\n      setGameOver(true);\r\n      setGameResult({ \r\n        type: \"resignation\", \r\n        winner: opponent && opponent.id ? opponent.id : null\r\n      });\r\n      setShowResignDialog(false);\r\n    } catch (error) {\r\n      console.error(\"Error handling resign:\", error);\r\n      addError(`Resign error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleOfferDraw = () => {\r\n    try {\r\n      console.log(`ðŸ¤ Offering draw in game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:offerDraw\", { gameId: safeGameId });\r\n      }\r\n      setShowDrawOfferDialog(false);\r\n    } catch (error) {\r\n      console.error(\"Error offering draw:\", error);\r\n      addError(`Draw offer error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleAcceptDraw = () => {\r\n    try {\r\n      console.log(`ðŸ¤ Accepting draw in game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:acceptDraw\", { gameId: safeGameId });\r\n      }\r\n      setGameOver(true);\r\n      setGameResult({ type: \"draw\", reason: \"agreement\" });\r\n      setReceivedDrawOffer(false);\r\n    } catch (error) {\r\n      console.error(\"Error accepting draw:\", error);\r\n      addError(`Accept draw error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleDeclineDraw = () => {\r\n    try {\r\n      console.log(`ðŸ‘Ž Declining draw in game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:declineDraw\", { gameId: safeGameId });\r\n      }\r\n      setReceivedDrawOffer(false);\r\n    } catch (error) {\r\n      console.error(\"Error declining draw:\", error);\r\n      addError(`Decline draw error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const setUndo = () => {\r\n    try {\r\n      console.log(`âª Requesting undo in game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:requestUndo\", { gameId: safeGameId });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error requesting undo:\", error);\r\n      addError(`Undo error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const setRedo = () => {\r\n    try {\r\n      console.log(`â© Requesting redo in game ${safeGameId}`);\r\n      if (safeGameId) {\r\n        socket.emit(\"game:requestRedo\", { gameId: safeGameId });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error requesting redo:\", error);\r\n      addError(`Redo error: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // Render errors list safely\r\n  const renderErrorsList = () => {\r\n    try {\r\n      const errorsArray = safeArray(debugInfo?.errors);\r\n      if (errorsArray.length === 0) {\r\n        return null;\r\n      }\r\n      \r\n      return (\r\n        <div>\r\n          <h5>Errors:</h5>\r\n          <ul style={{paddingLeft: '15px', margin: '5px 0'}}>\r\n            {errorsArray.map((err, i) => (\r\n              <li key={i}>\r\n                [{safeString(err?.time || 'unknown')}] \r\n                {safeString(err?.message || 'Error object')}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      );\r\n    } catch (error) {\r\n      console.error(\"Error rendering errors list:\", error);\r\n      return <div>Error displaying errors list</div>;\r\n    }\r\n  };\r\n  \r\n  // Conditional rendering after all hooks\r\n  if (!user && !isLoading) {\r\n    console.error(\"User object is undefined but authentication check is complete\");\r\n    return (\r\n      <div className=\"error-container\">\r\n        <h2>Authentication Error</h2>\r\n        <p>Unable to retrieve your user information. Please try logging in again.</p>\r\n        <button onClick={() => navigate('/signin')}>Go to Sign In</button>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (!safeGameId) {\r\n    return (\r\n      <div className=\"matchmaking-container\">\r\n        <h2>Find a Match</h2>\r\n        \r\n        <div className=\"matchmaking-options\">\r\n          <button onClick={() => {\r\n            try {\r\n              console.log(\"Looking for casual match\");\r\n              socket.emit(\"game:findMatch\", { gameMode: \"casual\", timeControl: \"10min\" });\r\n            } catch (error) {\r\n              console.error(\"Error finding casual match:\", error);\r\n              addError(`Find match error: ${error.message}`);\r\n            }\r\n          }}>\r\n            Find Casual Match\r\n          </button>\r\n          \r\n          <button onClick={() => {\r\n            try {\r\n              console.log(\"Looking for ranked match\");\r\n              socket.emit(\"game:findMatch\", { gameMode: \"ranked\", timeControl: \"10min\" });\r\n            } catch (error) {\r\n              console.error(\"Error finding ranked match:\", error);\r\n              addError(`Find match error: ${error.message}`);\r\n            }\r\n          }}>\r\n            Find Ranked Match\r\n          </button>\r\n        </div>\r\n        \r\n        {showDebug && (\r\n          <div className=\"debug-box\" style={{\r\n            marginTop: '20px',\r\n            padding: '10px',\r\n            border: '1px solid #666',\r\n            backgroundColor: '#222',\r\n            color: '#eee',\r\n            fontSize: '12px'\r\n          }}>\r\n            <h4>Debug: Listening for match</h4>\r\n            <p>Socket connected: <span style={{ color: socket.connected ? '#4CAF50' : '#F44336' }}>\r\n              {socket.connected ? 'Yes' : 'No'}\r\n            </span></p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <>\r\n        <Spinner />\r\n        {showDebug && (\r\n          <div style={{ position: 'fixed', bottom: '10px', right: '10px', background: '#222', color: '#fff', padding: '10px', maxWidth: '300px', fontSize: '11px' }}>\r\n            <p>Loading game: {safeGameId}</p>\r\n            <p>Attempt #{debugInfo.loadAttempts}</p>\r\n            <p>Socket connected: {debugInfo.socketConnected ? 'Yes' : 'No'}</p>\r\n          </div>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return (\r\n      <div className=\"error-container\" style={{ padding: \"20px\", textAlign: \"center\" }}>\r\n        <h2>User Data Not Available</h2>\r\n        <p>Unable to load user data. Please try refreshing or sign in again.</p>\r\n        <button \r\n          onClick={() => navigate('/signin')}\r\n          style={{ padding: \"10px 20px\", marginTop: \"20px\" }}\r\n        >\r\n          Go to Sign In\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"play-container\">\r\n      {/* Debug panel */}\r\n      {showDebug && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          top: '10px',\r\n          right: '10px',\r\n          backgroundColor: 'rgba(0,0,0,0.8)',\r\n          color: 'white',\r\n          padding: '10px',\r\n          zIndex: 1000,\r\n          fontSize: '11px',\r\n          maxWidth: '300px',\r\n          maxHeight: '300px',\r\n          overflow: 'auto'\r\n        }}>\r\n          <button \r\n            onClick={() => setShowDebug(false)} \r\n            style={{float: 'right', marginLeft: '5px'}}\r\n          >\r\n            X\r\n          </button>\r\n          <h4>Game Debug</h4>\r\n          <p>Game ID: <code>{safeString(debugInfo?.gameId || 'Not set')}</code></p>\r\n          <p>Socket: <span style={{color: debugInfo?.socketConnected ? 'lime' : 'red'}}>\r\n            {debugInfo?.socketConnected ? 'Connected' : 'Disconnected'}\r\n          </span></p>\r\n          <p>Player: {safeUsername}</p>\r\n          <p>Opponent: {safeOpponentName}</p>\r\n          <p>Color: {safePlayerColor}</p>\r\n          <p>Turn: {safeString(currentTurn || 'Unknown')}</p>\r\n          \r\n          {renderErrorsList()}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"game-info\">\r\n        {opponent && (\r\n          <div className=\"opponent-info\">\r\n            <h3>{safeOpponentName}</h3>\r\n            <div className=\"rating\">Rating: {opponent.elo || '?'}</div>\r\n          </div>\r\n        )}\r\n        \r\n        <div className=\"game-status\">\r\n          {gameOver ? (\r\n            <div className=\"game-result\">\r\n              <h2>Game Over</h2>\r\n              {gameResult && gameResult.type === \"checkmate\" && (\r\n                <p>\r\n                  Checkmate! {user && gameResult.winner === user.id\r\n                    ? \"You won\" \r\n                    : \"You lost\"}\r\n                </p>\r\n              )}\r\n              {gameResult && gameResult.type === \"draw\" && (\r\n                <p>Game drawn by {safeString(gameResult.reason) || 'agreement'}</p>\r\n              )}\r\n              {gameResult && gameResult.type === \"resignation\" && (\r\n                <p>\r\n                  {user && gameResult.winner === user.id\r\n                    ? \"Opponent resigned. You won!\"\r\n                    : \"You resigned. You lost.\"}\r\n                </p>\r\n              )}\r\n              {gameResult && gameResult.type === \"timeout\" && (\r\n                <p>\r\n                  {user && gameResult.winner === user.id\r\n                    ? \"Opponent ran out of time. You won!\"\r\n                    : \"You ran out of time. You lost.\"}\r\n                </p>\r\n              )}\r\n              <button \r\n                className=\"new-game-btn\"\r\n                onClick={() => navigate(\"/lobby\")}\r\n              >\r\n                Back to Lobby\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div>\r\n              <div className=\"current-turn\">\r\n                {currentTurn === safePlayerColor ? \"Your turn\" : \"Opponent's turn\"}\r\n              </div>\r\n              {inCheck && <div className=\"check-alert\">Check!</div>}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"game-board-container\">\r\n        <Board\r\n          board={safeArray(board)}\r\n          position={position && typeof position === 'object' ? position : {}}\r\n          playerColor={safePlayerColor}\r\n          possibleMoves={possibleMoves && typeof possibleMoves === 'object' ? possibleMoves : {}}\r\n          onMove={makeMove}\r\n          disabled={gameOver || currentTurn !== safePlayerColor}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"game-sidebar\">\r\n        <div className=\"move-history-container\">\r\n          <MoveHistory moves={safeMoves} />\r\n        </div>\r\n        \r\n        <div className=\"game-controls-container\">\r\n          <GameControls\r\n            onNewGame={() => navigate(\"/lobby\")}\r\n            canResign={!gameOver}\r\n            onResign={() => setShowResignDialog(true)}\r\n            canOfferDraw={!gameOver}\r\n            onOfferDraw={() => setShowDrawOfferDialog(true)}\r\n            canUndo={safeMoves.length > 0 && !gameOver}\r\n            onUndoRequest={() => setUndo()}\r\n            canRedo={true}\r\n            onRedoRequest={() => setRedo()}\r\n          />\r\n        </div>\r\n\r\n        {/* Player info */}\r\n        <div className=\"player-info\">\r\n          <h3>You ({safePlayerColor})</h3>\r\n          <div className=\"rating\">Rating: {user && typeof user.elo !== 'undefined' ? user.elo : '?'}</div>\r\n        </div>\r\n\r\n        {/* Debug button */}\r\n        {process.env.NODE_ENV === 'development' && !showDebug && (\r\n          <button \r\n            onClick={() => setShowDebug(true)}\r\n            style={{\r\n              position: 'fixed',\r\n              bottom: '10px',\r\n              right: '10px',\r\n              background: '#444',\r\n              color: '#fff',\r\n              border: 'none',\r\n              padding: '5px 10px',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: '12px'\r\n            }}\r\n          >\r\n            Show Debug\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Resign confirmation dialog */}\r\n      {showResignDialog && (\r\n        <div className=\"dialog-overlay\">\r\n          <div className=\"dialog\">\r\n            <h3>Resign Game?</h3>\r\n            <p>Are you sure you want to resign? This will count as a loss.</p>\r\n            <div className=\"dialog-buttons\">\r\n              <button onClick={handleResign} className=\"confirm-btn\">\r\n                Yes, Resign\r\n              </button>\r\n              <button onClick={() => setShowResignDialog(false)} className=\"cancel-btn\">\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Draw offer dialog */}\r\n      {showDrawOfferDialog && (\r\n        <div className=\"dialog-overlay\">\r\n          <div className=\"dialog\">\r\n            <h3>Offer Draw?</h3>\r\n            <p>Send a draw offer to your opponent?</p>\r\n            <div className=\"dialog-buttons\">\r\n              <button onClick={handleOfferDraw} className=\"confirm-btn\">\r\n                Yes, Offer Draw\r\n              </button>\r\n              <button onClick={() => setShowDrawOfferDialog(false)} className=\"cancel-btn\">\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Received draw offer dialog */}\r\n      {receivedDrawOffer && (\r\n        <div className=\"dialog-overlay\">\r\n          <div className=\"dialog\">\r\n            <h3>Draw Offered</h3>\r\n            <p>Your opponent has offered a draw. Do you accept?</p>\r\n            <div className=\"dialog-buttons\">\r\n              <button onClick={handleAcceptDraw} className=\"confirm-btn\">\r\n                Accept Draw\r\n              </button>\r\n              <button onClick={handleDeclineDraw} className=\"cancel-btn\">\r\n                Decline\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Play;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}