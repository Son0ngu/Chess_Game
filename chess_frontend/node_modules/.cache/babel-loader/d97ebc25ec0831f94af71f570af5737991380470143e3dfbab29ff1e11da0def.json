{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { socket } from '../services/socket';\n\n/**\r\n * Custom hook to manage chess game state and socket communication\r\n * @param {string} gameId - The ID of the current game\r\n * @returns {Object} Chess game state and methods\r\n */\nconst useChess = gameId => {\n  _s();\n  const {\n    user\n  } = useAuth();\n\n  // Game state\n  const [board, setBoard] = useState(initialBoard());\n  const [position, setPosition] = useState(null);\n  const [moves, setMoves] = useState([]);\n  const [currentTurn, setCurrentTurn] = useState('white');\n  const [playerColor, setPlayerColor] = useState(null);\n  const [possibleMoves, setPossibleMoves] = useState({});\n  const [selectedPiece, setSelectedPiece] = useState(null);\n  const [pastPositions, setPastPositions] = useState([]);\n  const [futurePositions, setFuturePositions] = useState([]);\n  const [inCheck, setInCheck] = useState(false);\n  const [gameStatus, setGameStatus] = useState({\n    isGameOver: false,\n    result: null\n  });\n\n  // Initialize game when component mounts\n  useEffect(() => {\n    if (!gameId) return;\n\n    // Join the game\n    socket.emit('game:join', {\n      gameId\n    });\n\n    // Handle initial game data\n    const handleGameData = data => {\n      setBoard(data.board || initialBoard());\n      setPosition(data.position || null);\n      setMoves(data.moves || []);\n      setCurrentTurn(data.currentTurn || 'white');\n\n      // Set player color based on the player's user ID\n      const playerData = data.players.find(p => p.id === (user === null || user === void 0 ? void 0 : user.id));\n      setPlayerColor((playerData === null || playerData === void 0 ? void 0 : playerData.color) || 'white');\n\n      // Update game status\n      setInCheck(data.inCheck || false);\n      setPossibleMoves(data.legalMoves || {});\n    };\n    const handleGameUpdate = data => {\n      // Cập nhật bàn cờ, lịch sử nước đi, và các trạng thái khác\n      setBoard(data.board); // Cập nhật bàn cờ\n      setPosition(data.position); // Cập nhật FEN của bàn cờ\n      setMoves(data.history || []); // Cập nhật lịch sử nước đi\n      setCurrentTurn(data.currentTurn); // Cập nhật lượt đi\n      setInCheck(data.inCheck || false); // Kiểm tra trạng thái bị check\n      setPossibleMoves(data.legalMoves || {}); // Cập nhật các nước đi hợp lệ\n\n      if (data.gameOver) {\n        setGameStatus({\n          isGameOver: true,\n          result: data.result\n        });\n      }\n    };\n\n    // Listen for game updates\n    socket.on('game:update', data => {\n      console.log(\"Game update received:\", data.board, data.position);\n      setBoard(data.board);\n      setPosition(data.position);\n      //setMoves(prevMoves => [...prevMoves, data.lastMove]);\n      setCurrentTurn(data.currentTurn);\n      setInCheck(data.inCheck || false);\n      setPossibleMoves(data.legalMoves || {});\n      if (data.lastMove) {\n        setMoves(prevMoves => [...prevMoves, data.lastMove]);\n      } else if (data.history) {\n        setMoves(data.history); // fallback khi undo hoặc khi join game\n      }\n      if (data.gameOver) {\n        setGameStatus({\n          isGameOver: true,\n          result: data.result\n        });\n      }\n    });\n\n    // Listen for game data when joining\n    socket.on('game:data', handleGameData);\n\n    // Listen for move validation failures\n    socket.on('game:moveRejected', error => {\n      console.error('Move rejected:', error);\n      // Reset any UI state needed after failed move\n    });\n\n    // Cleanup on unmount\n    return () => {\n      socket.off('game:update');\n      socket.off('game:data');\n      socket.off('game:moveRejected');\n      socket.emit('game:leave', {\n        gameId\n      });\n    };\n  }, [gameId, user]);\n\n  // Fix for undo declined event handler\n  useEffect(() => {\n    const handleUndoDeclined = ({\n      by\n    }) => {\n      alert(`${by} đã từ chối yêu cầu undo.`);\n    };\n\n    // Fix for undo confirmed event handler\n    const handleUndoConfirmed = ({\n      by,\n      from\n    }) => {\n      if (user && from === user.username) return; // Bỏ qua nếu là mình gửi\n\n      const accept = window.confirm(`${from} muốn undo. Bạn có đồng ý không?`);\n      socket.emit('game:undoResponse', {\n        gameId,\n        accepted: accept\n      });\n    };\n    socket.on('game:undoDeclined', handleUndoDeclined);\n    socket.on('game:undoConfirmed', handleUndoConfirmed);\n    return () => {\n      socket.off('game:undoDeclined');\n      socket.off('game:undoConfirmed');\n    };\n  }, [gameId, user]);\n\n  // Handle piece selection and move highlighting\n  const selectPiece = useCallback((piece, position) => {\n    // Only allow selection of the player's own pieces during their turn\n    if (piece && piece.color === playerColor && currentTurn === playerColor) {\n      setSelectedPiece({\n        piece,\n        position\n      });\n      // Highlight possible moves for this piece\n    } else {\n      setSelectedPiece(null);\n    }\n  }, [playerColor, currentTurn]);\n\n  // Make a move\n  const makeMove = useCallback((from, to) => {\n    if (gameStatus.isGameOver || currentTurn !== playerColor) {\n      return false;\n    }\n    setPastPositions(prev => [...prev, position]);\n    setFuturePositions([]);\n\n    // Send move to server\n    socket.emit('game:move', {\n      gameId,\n      from,\n      to\n    });\n    return true;\n  }, [gameId, currentTurn, playerColor, gameStatus.isGameOver, position]);\n\n  // Request undo\n  const undo = useCallback(() => {\n    if (!gameId || gameStatus.isGameOver || currentTurn !== playerColor) {\n      return false;\n    }\n\n    // Send undo request to the server\n    socket.emit('game:requestUndo', {\n      gameId\n    });\n\n    // Optionally, you can disable the undo button or show a loading state while waiting for the server response\n    return true;\n  }, [gameId, currentTurn, playerColor, gameStatus.isGameOver]);\n\n  // Handle redo (typically only for offline or analysis mode)\n  const redo = useCallback(() => {\n    if (futurePositions.length === 0) return;\n    const newPosition = futurePositions[futurePositions.length - 1];\n    setPastPositions(prev => [...prev, position]);\n    setFuturePositions(prev => prev.slice(0, -1));\n    setPosition(newPosition);\n\n    // Emit redo event to server if needed\n    socket.emit('game:redo', {\n      gameId,\n      position: newPosition\n    });\n  }, [futurePositions, position, gameId]);\n\n  // Reset game\n  const reset = useCallback(() => {\n    socket.emit('game:reset', {\n      gameId\n    });\n  }, [gameId]);\n  return {\n    board,\n    position,\n    currentTurn,\n    playerColor,\n    moves,\n    inCheck,\n    possibleMoves,\n    selectedPiece,\n    gameStatus,\n    selectPiece,\n    makeMove,\n    undo,\n    redo,\n    reset\n  };\n};\n\n// Helper function to create initial empty board\n_s(useChess, \"kaDYy28QI1gpxUaMIBKV4x0xVMw=\", false, function () {\n  return [useAuth];\n});\nfunction initialBoard() {\n  // Create 8x8 empty board representation\n  // This could be replaced with FEN parsing if you use chess.js or another library\n  return Array(8).fill().map(() => Array(8).fill(null));\n}\nexport default useChess;","map":{"version":3,"names":["useState","useEffect","useCallback","useAuth","socket","useChess","gameId","_s","user","board","setBoard","initialBoard","position","setPosition","moves","setMoves","currentTurn","setCurrentTurn","playerColor","setPlayerColor","possibleMoves","setPossibleMoves","selectedPiece","setSelectedPiece","pastPositions","setPastPositions","futurePositions","setFuturePositions","inCheck","setInCheck","gameStatus","setGameStatus","isGameOver","result","emit","handleGameData","data","playerData","players","find","p","id","color","legalMoves","handleGameUpdate","history","gameOver","on","console","log","lastMove","prevMoves","error","off","handleUndoDeclined","by","alert","handleUndoConfirmed","from","username","accept","window","confirm","accepted","selectPiece","piece","makeMove","to","prev","undo","redo","length","newPosition","slice","reset","Array","fill","map"],"sources":["D:/Code/Chess_Game/chess_frontend/src/hooks/useChess.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { socket } from '../services/socket';\r\n\r\n/**\r\n * Custom hook to manage chess game state and socket communication\r\n * @param {string} gameId - The ID of the current game\r\n * @returns {Object} Chess game state and methods\r\n */\r\nconst useChess = (gameId) => {\r\n  const { user } = useAuth();\r\n  \r\n  // Game state\r\n  const [board, setBoard] = useState(initialBoard());\r\n  const [position, setPosition] = useState(null);\r\n  const [moves, setMoves] = useState([]);\r\n  const [currentTurn, setCurrentTurn] = useState('white');\r\n  const [playerColor, setPlayerColor] = useState(null);\r\n  const [possibleMoves, setPossibleMoves] = useState({});\r\n  const [selectedPiece, setSelectedPiece] = useState(null);\r\n  const [pastPositions, setPastPositions] = useState([]);\r\n  const [futurePositions, setFuturePositions] = useState([]);\r\n  const [inCheck, setInCheck] = useState(false);\r\n  const [gameStatus, setGameStatus] = useState({\r\n    isGameOver: false,\r\n    result: null\r\n  });\r\n  \r\n  // Initialize game when component mounts\r\n  useEffect(() => {\r\n    if (!gameId) return;\r\n\r\n    // Join the game\r\n    socket.emit('game:join', { gameId });\r\n    \r\n    // Handle initial game data\r\n    const handleGameData = (data) => {\r\n      setBoard(data.board || initialBoard());\r\n      setPosition(data.position || null);\r\n      setMoves(data.moves || []);\r\n      setCurrentTurn(data.currentTurn || 'white');\r\n      \r\n      // Set player color based on the player's user ID\r\n      const playerData = data.players.find(p => p.id === user?.id);\r\n      setPlayerColor(playerData?.color || 'white');\r\n      \r\n      // Update game status\r\n      setInCheck(data.inCheck || false);\r\n      setPossibleMoves(data.legalMoves || {});\r\n    };\r\n\r\n    const handleGameUpdate = (data) => {\r\n      // Cập nhật bàn cờ, lịch sử nước đi, và các trạng thái khác\r\n      setBoard(data.board);  // Cập nhật bàn cờ\r\n      setPosition(data.position);  // Cập nhật FEN của bàn cờ\r\n      setMoves(data.history || []);  // Cập nhật lịch sử nước đi\r\n      setCurrentTurn(data.currentTurn);  // Cập nhật lượt đi\r\n      setInCheck(data.inCheck || false);  // Kiểm tra trạng thái bị check\r\n      setPossibleMoves(data.legalMoves || {});  // Cập nhật các nước đi hợp lệ\r\n\r\n      if (data.gameOver) {\r\n        setGameStatus({\r\n          isGameOver: true,\r\n          result: data.result\r\n        });\r\n      }\r\n    };\r\n\r\n    // Listen for game updates\r\n    socket.on('game:update', (data) => {\r\n      console.log(\"Game update received:\", data.board, data.position);\r\n      setBoard(data.board);\r\n      setPosition(data.position);\r\n      //setMoves(prevMoves => [...prevMoves, data.lastMove]);\r\n      setCurrentTurn(data.currentTurn);\r\n      setInCheck(data.inCheck || false);\r\n      setPossibleMoves(data.legalMoves || {});\r\n\r\n      if (data.lastMove) {\r\n        setMoves(prevMoves => [...prevMoves, data.lastMove]);\r\n      } else if (data.history) {\r\n        setMoves(data.history); // fallback khi undo hoặc khi join game\r\n      }\r\n      \r\n      if (data.gameOver) {\r\n        setGameStatus({\r\n          isGameOver: true,\r\n          result: data.result\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Listen for game data when joining\r\n    socket.on('game:data', handleGameData);\r\n    \r\n    // Listen for move validation failures\r\n    socket.on('game:moveRejected', (error) => {\r\n      console.error('Move rejected:', error);\r\n      // Reset any UI state needed after failed move\r\n    });\r\n    \r\n    // Cleanup on unmount\r\n    return () => {\r\n      socket.off('game:update');\r\n      socket.off('game:data');\r\n      socket.off('game:moveRejected');\r\n      socket.emit('game:leave', { gameId });\r\n    };\r\n  }, [gameId, user]);\r\n\r\n  // Fix for undo declined event handler\r\n  useEffect(() => {\r\n    const handleUndoDeclined = ({ by }) => {\r\n      alert(`${by} đã từ chối yêu cầu undo.`);\r\n    };\r\n\r\n    // Fix for undo confirmed event handler\r\n    const handleUndoConfirmed = ({ by, from }) => {\r\n      if (user && from === user.username) return; // Bỏ qua nếu là mình gửi\r\n\r\n      const accept = window.confirm(`${from} muốn undo. Bạn có đồng ý không?`);\r\n      socket.emit('game:undoResponse', {\r\n        gameId,\r\n        accepted: accept\r\n      });\r\n    };\r\n\r\n    socket.on('game:undoDeclined', handleUndoDeclined);\r\n    socket.on('game:undoConfirmed', handleUndoConfirmed);\r\n\r\n    return () => {\r\n      socket.off('game:undoDeclined');\r\n      socket.off('game:undoConfirmed');\r\n    };\r\n  }, [gameId, user]);\r\n  \r\n  // Handle piece selection and move highlighting\r\n  const selectPiece = useCallback((piece, position) => {\r\n    // Only allow selection of the player's own pieces during their turn\r\n    if (piece && piece.color === playerColor && currentTurn === playerColor) {\r\n      setSelectedPiece({ piece, position });\r\n      // Highlight possible moves for this piece\r\n    } else {\r\n      setSelectedPiece(null);\r\n    }\r\n  }, [playerColor, currentTurn]);\r\n  \r\n  // Make a move\r\n  const makeMove = useCallback((from, to) => {\r\n    if (gameStatus.isGameOver || currentTurn !== playerColor) {\r\n      return false;\r\n    }\r\n\r\n    setPastPositions(prev => [...prev, position]);\r\n    setFuturePositions([]);\r\n    \r\n    // Send move to server\r\n    socket.emit('game:move', {\r\n      gameId,\r\n      from,\r\n      to\r\n    });\r\n    \r\n    return true;\r\n  }, [gameId, currentTurn, playerColor, gameStatus.isGameOver, position]);\r\n  \r\n  // Request undo\r\n  const undo = useCallback(() => {\r\n    if (!gameId || gameStatus.isGameOver || currentTurn !== playerColor) {\r\n      return false;\r\n    }\r\n    \r\n    // Send undo request to the server\r\n    socket.emit('game:requestUndo', { gameId });\r\n  \r\n    // Optionally, you can disable the undo button or show a loading state while waiting for the server response\r\n    return true;\r\n  }, [gameId, currentTurn, playerColor, gameStatus.isGameOver]);\r\n\r\n\r\n  // Handle redo (typically only for offline or analysis mode)\r\n  const redo = useCallback(() => {\r\n    if (futurePositions.length === 0) return;\r\n    \r\n    const newPosition = futurePositions[futurePositions.length - 1];\r\n    setPastPositions(prev => [...prev, position]);\r\n    setFuturePositions(prev => prev.slice(0, -1));\r\n    setPosition(newPosition);\r\n    \r\n    // Emit redo event to server if needed\r\n    socket.emit('game:redo', { gameId, position: newPosition });\r\n  }, [futurePositions, position, gameId]);\r\n  \r\n  // Reset game\r\n  const reset = useCallback(() => {\r\n    socket.emit('game:reset', { gameId });\r\n  }, [gameId]);\r\n  \r\n  return {\r\n    board,\r\n    position,\r\n    currentTurn,\r\n    playerColor,\r\n    moves,\r\n    inCheck,\r\n    possibleMoves,\r\n    selectedPiece,\r\n    gameStatus,\r\n    selectPiece,\r\n    makeMove,\r\n    undo,\r\n    redo,\r\n    reset\r\n  };\r\n};\r\n\r\n// Helper function to create initial empty board\r\nfunction initialBoard() {\r\n  // Create 8x8 empty board representation\r\n  // This could be replaced with FEN parsing if you use chess.js or another library\r\n  return Array(8).fill().map(() => Array(8).fill(null));\r\n}\r\n\r\nexport default useChess;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}